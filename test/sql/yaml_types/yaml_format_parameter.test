# name: test/sql/yaml_types/yaml_format_parameter.test
# description: Test YAML formatting functionality with format_yaml function
# group: [yaml_types]

require yaml

statement ok
PRAGMA enable_verification

# Test value_to_yaml default behavior (single parameter, returns YAML type)
query I
SELECT value_to_yaml({'name': 'John', 'age': 30}) AS default_yaml;
----
{name: John, age: 30}

# Test format_yaml with flow style (returns VARCHAR)
query I
SELECT format_yaml({'name': 'John', 'age': 30}, {'style': 'flow'}) AS flow_format;
----
{name: John, age: 30}

# Test format_yaml with block style (multi-line YAML)
query I
SELECT format_yaml({'name': 'John', 'items': [1, 2, 3]}, {'style': 'block'}) AS block_format;
----
name: John\nitems:\n  - 1\n  - 2\n  - 3

# Test NULL value handling
query I
SELECT value_to_yaml(NULL) AS null_value;
----
null

# Test format_yaml with NULL style parameter (should default to flow)
query I
SELECT format_yaml({'a': 1}, {'style': NULL}) AS null_format;
----
{a: 1}

# Test json_to_yaml default format
query I
SELECT json_to_yaml('{"name": "John", "age": 30}') AS json_default;
----
{name: John, age: 30}

# Test json_to_yaml with explicit flow format
query I
SELECT json_to_yaml('{"name": "John", "age": 30}', {'style': 'flow'}) AS json_flow;
----
{name: John, age: 30}

# Test json_to_yaml with block format
query I
SELECT json_to_yaml('{"name": "John", "items": [1, 2, 3]}', {'style': 'block'}) AS json_block;
----
name: John\nitems:\n  - 1\n  - 2\n  - 3

# Test error handling for invalid format in format_yaml
statement error
SELECT format_yaml({'a': 1}, {'style': 'invalid'});
----
Invalid YAML style 'invalid'. Valid options are 'flow' or 'block'.

# Test error handling for invalid format in json_to_yaml
statement error
SELECT json_to_yaml('{"a": 1}', {'style': 'invalid'});
----
Invalid format 'invalid'. Must be 'flow' or 'block'

# Test with array values
query I
SELECT value_to_yaml([1, 2, 3]) AS array_default;
----
[1, 2, 3]

query I
SELECT format_yaml([1, 2, 3], {'style': 'block'}) AS array_block;
----
- 1\n- 2\n- 3

query I
SELECT format_yaml([1, 2, 3], {'style': 'flow'}) AS array_flow;
----
[1, 2, 3]

# Test with simple scalar values
query I
SELECT format_yaml('hello', {'style': 'flow'}) AS scalar_flow;
----
hello

query I
SELECT format_yaml('hello', {'style': 'block'}) AS scalar_block;
----
hello